
<!DOCTYPE HTML>
<html lang="fr" >
    <head>
        <meta charset="UTF-8">
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <title>Programmation en Python · Documentation of the Poppy Platform</title>
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="description" content="">
        <meta name="generator" content="GitBook 3.2.3">
        
        
        
    
    <link rel="stylesheet" href="../../gitbook/style.css">

    
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-language-picker/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-page-toc/page-toc.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-richquotes/plugin.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-search-plus/search.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-toggle-chapters/toggle.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-highlight/website.css">
                
            
                
                <link rel="stylesheet" href="../../gitbook/gitbook-plugin-fontsettings/website.css">
                
            
        

    

    
        
        <link rel="stylesheet" href="../styles/website.css">
        
    
        
    
        
    
        
    
        
    
        
    

        
    
    
    <meta name="HandheldFriendly" content="true"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black">
    <link rel="apple-touch-icon-precomposed" sizes="152x152" href="../../gitbook/images/apple-touch-icon-precomposed-152.png">
    <link rel="shortcut icon" href="../../gitbook/images/favicon.ico" type="image/x-icon">

    
    <link rel="next" href="rest.html" />
    
    
    <link rel="prev" href="notebooks.html" />
    

    </head>
    <body>
        
<div class="book">
    <div class="book-summary">
        
            
<div id="book-search-input" role="search">
    <input type="text" placeholder="Tapez pour rechercher" />
</div>

            
                <nav role="navigation">
                


<ul class="summary">
    
    

    

    
        
        
    
        <li class="chapter " data-level="1.1" data-path="../">
            
                <a href="../">
            
                    
                        <b>1.1.</b>
                    
                    À propos de cette documentation
            
                </a>
            

            
        </li>
    

    
        
        <li class="header">Premiers pas avec Poppy</li>
        
        
    
        <li class="chapter " data-level="2.1" data-path="../getting-started/">
            
                <a href="../getting-started/">
            
                    
                        <b>2.1.</b>
                    
                    Premiers pas
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="2.1.1" data-path="../getting-started/connect.html">
            
                <a href="../getting-started/connect.html">
            
                    
                        <b>2.1.1.</b>
                    
                    Se connecter au robot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.2" data-path="../getting-started/program-the-robot.html">
            
                <a href="../getting-started/program-the-robot.html">
            
                    
                        <b>2.1.2.</b>
                    
                    Programmer un robot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.3" data-path="../getting-started/visualize.html">
            
                <a href="../getting-started/visualize.html">
            
                    
                        <b>2.1.3.</b>
                    
                    Visualiser ou simuler
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="2.1.4" data-path="../getting-started/example-of-projects.html">
            
                <a href="../getting-started/example-of-projects.html">
            
                    
                        <b>2.1.4.</b>
                    
                    Exemples de projets
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Assemblage du robot</li>
        
        
    
        <li class="chapter " data-level="3.1" data-path="../assembly-guides/">
            
                <a href="../assembly-guides/">
            
                    
                        <b>3.1.</b>
                    
                    Guides d'assemblage
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1" data-path="../assembly-guides/ergo-jr/">
            
                <a href="../assembly-guides/ergo-jr/">
            
                    
                        <b>3.1.1.</b>
                    
                    Assembler l’Ergo Jr
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="3.1.1.1" data-path="../assembly-guides/ergo-jr/bom.html">
            
                <a href="../assembly-guides/ergo-jr/bom.html">
            
                    
                        <b>3.1.1.1.</b>
                    
                    La liste des composants (BOM)
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.2" data-path="../assembly-guides/ergo-jr/electronic-assembly.html">
            
                <a href="../assembly-guides/ergo-jr/electronic-assembly.html">
            
                    
                        <b>3.1.1.2.</b>
                    
                    Assemblage électronique
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.3" data-path="../assembly-guides/ergo-jr/motor-configuration.html">
            
                <a href="../assembly-guides/ergo-jr/motor-configuration.html">
            
                    
                        <b>3.1.1.3.</b>
                    
                    Configuration des moteurs
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.1.4" data-path="../assembly-guides/ergo-jr/mechanical-construction.html">
            
                <a href="../assembly-guides/ergo-jr/mechanical-construction.html">
            
                    
                        <b>3.1.1.4.</b>
                    
                    Assemblage des pièces mécaniques
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="3.1.2" data-path="../assembly-guides/poppy-humanoid/">
            
                <a href="../assembly-guides/poppy-humanoid/">
            
                    
                        <b>3.1.2.</b>
                    
                    Assembler Poppy Humanoid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="3.1.3" data-path="../assembly-guides/poppy-torso/">
            
                <a href="../assembly-guides/poppy-torso/">
            
                    
                        <b>3.1.3.</b>
                    
                    Assembler Poppy Torso
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Installation des logiciels</li>
        
        
    
        <li class="chapter " data-level="4.1" data-path="../installation/">
            
                <a href="../installation/">
            
                    
                        <b>4.1.</b>
                    
                    Installation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="4.1.1" data-path="../installation/install-zeroconf.html">
            
                <a href="../installation/install-zeroconf.html">
            
                    
                        <b>4.1.1.</b>
                    
                    Installez Bonjour/Zeroconf
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.2" data-path="../installation/burn-an-image-file.html">
            
                <a href="../installation/burn-an-image-file.html">
            
                    
                        <b>4.1.2.</b>
                    
                    Télécharger et graver l'image système
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.3" data-path="../installation/install-poppy-softwares.html">
            
                <a href="../installation/install-poppy-softwares.html">
            
                    
                        <b>4.1.3.</b>
                    
                    Installer les logiciels Poppy
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.4" data-path="../installation/install-vrep.html">
            
                <a href="../installation/install-vrep.html">
            
                    
                        <b>4.1.4.</b>
                    
                    Installation du simulateur  CoppeliaSim
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.5" data-path="../installation/install-drivers.html">
            
                <a href="../installation/install-drivers.html">
            
                    
                        <b>4.1.5.</b>
                    
                    Installer les pilotes USB vers port série
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="4.1.6" data-path="../installation/install-a-poppy-board.html">
            
                <a href="../installation/install-a-poppy-board.html">
            
                    
                        <b>4.1.6.</b>
                    
                    Installer un ordinateur embarqué pour un robot Poppy
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Programmation du robot</li>
        
        
    
        <li class="chapter " data-level="5.1" data-path="./">
            
                <a href="./">
            
                    
                        <b>5.1.</b>
                    
                    Programmation
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.1.1" data-path="snap.html">
            
                <a href="snap.html">
            
                    
                        <b>5.1.1.</b>
                    
                    Programmation avec Snap!
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.2" data-path="notebooks.html">
            
                <a href="notebooks.html">
            
                    
                        <b>5.1.2.</b>
                    
                    Utilisation des notebooks Jupyter
            
                </a>
            

            
        </li>
    
        <li class="chapter active" data-level="5.1.3" data-path="python.html">
            
                <a href="python.html">
            
                    
                        <b>5.1.3.</b>
                    
                    Programmation en Python
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.4" data-path="rest.html">
            
                <a href="rest.html">
            
                    
                        <b>5.1.4.</b>
                    
                    API des robots
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.5" data-path="../demo-activities/">
            
                <a href="../demo-activities/">
            
                    
                        <b>5.1.5.</b>
                    
                    Activités
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.1.6" data-path="../demo-activities/snap4arduino.html">
            
                <a href="../demo-activities/snap4arduino.html">
            
                    
                        <b>5.1.6.</b>
                    
                    Lien avec Snap4Arduino
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.2" data-path="../from-simulation-to-real-robot/">
            
                <a href="../from-simulation-to-real-robot/">
            
                    
                        <b>5.2.</b>
                    
                    De la simulation au robot tangible
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.2.1" data-path="../from-simulation-to-real-robot/using-jupyter.html">
            
                <a href="../from-simulation-to-real-robot/using-jupyter.html">
            
                    
                        <b>5.2.1.</b>
                    
                    Programmer avec les notebooks Jupyter
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.2.2" data-path="../from-simulation-to-real-robot/using-snap.html">
            
                <a href="../from-simulation-to-real-robot/using-snap.html">
            
                    
                        <b>5.2.2.</b>
                    
                    Snap! sur le robot tangible
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    
        <li class="chapter " data-level="5.3" data-path="../software-libraries/">
            
                <a href="../software-libraries/">
            
                    
                        <b>5.3.</b>
                    
                    Documentation des bibliothèques logicielles
            
                </a>
            

            
            <ul class="articles">
                
    
        <li class="chapter " data-level="5.3.1" data-path="../software-libraries/pypot.html">
            
                <a href="../software-libraries/pypot.html">
            
                    
                        <b>5.3.1.</b>
                    
                    Pypot
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.2" data-path="../software-libraries/poppy-creature.html">
            
                <a href="../software-libraries/poppy-creature.html">
            
                    
                        <b>5.3.2.</b>
                    
                    Poppy-creature
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.3" data-path="../software-libraries/poppy-ergo-jr.html">
            
                <a href="../software-libraries/poppy-ergo-jr.html">
            
                    
                        <b>5.3.3.</b>
                    
                    Poppy Ergo Jr
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.4" data-path="../software-libraries/poppy-humanoid.html">
            
                <a href="../software-libraries/poppy-humanoid.html">
            
                    
                        <b>5.3.4.</b>
                    
                    Poppy Humanoid
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="5.3.5" data-path="../software-libraries/poppy-torso.html">
            
                <a href="../software-libraries/poppy-torso.html">
            
                    
                        <b>5.3.5.</b>
                    
                    Poppy Torso
            
                </a>
            

            
        </li>
    

            </ul>
            
        </li>
    

    
        
        <li class="header">Annexes</li>
        
        
    
        <li class="chapter " data-level="6.1" data-path="../appendix/faq.html">
            
                <a href="../appendix/faq.html">
            
                    
                        <b>6.1.</b>
                    
                    Résolution des problèmes
            
                </a>
            

            
        </li>
    
        <li class="chapter " data-level="6.2" data-path="../appendix/contribute.html">
            
                <a href="../appendix/contribute.html">
            
                    
                        <b>6.2.</b>
                    
                    Contribuez
            
                </a>
            

            
        </li>
    

    

    <li class="divider"></li>

    <li>
        <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
            Publié avec GitBook
        </a>
    </li>
</ul>


                </nav>
            
        
    </div>

    <div class="book-body">
        
            <div class="body-inner">
                
                    

<div class="book-header" role="navigation">
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href=".." >Programmation en Python</a>
    </h1>
</div>




                    <div class="page-wrapper" tabindex="-1" role="main">
                        <div class="page-inner">
                            
<div class="search-plus" id="book-search-results">
    <div class="search-noresults">
    
                                <section class="normal markdown-section">
                                
                                <h1 id="programmation-des-robots-poppy-en-python">Programmation des robots Poppy en Python</h1>
<p>Ce chapitre vous guidera de mani&#xE8;re &#xE0; pouvoir contr&#xF4;ler les robots Poppy en Python. Comme c&apos;est le langage actuel pour &#xE9;crire des librairies Poppy, vous verrez comment acc&#xE9;der tous les diff&#xE9;rents niveaux de contr&#xF4;le, du plus haut vers le plus bas.</p>
<p>Nous allons d&#xE9;tailler tout ce que vous devez savoir pour pouvoir programmer directement le robot en utilisant le Python embarqu&#xE9; dans le robot Poppy ou pour l&apos;installer localement. Remarquez que ce chapitre ne pr&#xE9;tend pas vous apprendre le langage Python ou la programmation &#xE0; partir de z&#xE9;ro et donc si vous &#xEA;tes totalement nouveau sur le langage Python, il peut &#xEA;tre bon de commencer avec un tutoriel de Python. Pourtant, nous essayons de garder les tutoriels aussi simples que possible et nous vous avertirons toujours lorsque certaines parties ciblent les utilisateurs les plus avanc&#xE9;s.</p>
<p>Nous allons essayer de fournir autant d&apos;exemples que possible et de l&apos;axer sur l&#x2019;API compl&#xE8;te ainsi vous pouvez trouver et utiliser les fonctionnalit&#xE9;s moins courantes. La plupart des exemples et didacticiels sont disponibles comme une liste de <a href="http://jupyter.org" target="_blank">notebooks Jupyter</a>. Le prochain chapitre, <a href="notebooks.html">Galerie de notebooks Jupyter</a>, pr&#xE9;sente une liste descriptive de chaque notebook, de ce qu&apos;ils contiennent, comment ils peuvent &#xEA;tre utilis&#xE9;s, pour quel robot, etc.</p>
<p>Toutes les biblioth&#xE8;ques Poppy sont open source et sont distribu&#xE9;s sous la licence <a href="http://www.gnu.org/licenses/gpl.html" target="_blank">GPL v3</a>. Ainsi, vous pouvez acc&#xE9;der librement le code source sur <a href="https://github.com/poppy-project" target="_blank">GitHub</a>. N&#x2019;h&#xE9;sitez pas &#xE0; cr&#xE9;er un fork, envoyer un pull/request et &#xE0; contribuer !</p>
<h2 id="pourquoi-python">Pourquoi Python?</h2>
<p><img src="../img/python/powered.png" alt="Python powered" height="150"></p>
<p>Les biblioth&#xE8;ques d&#xE9;velopp&#xE9;es pour le projet Poppy ont &#xE9;t&#xE9; con&#xE7;us dans le but de rendre facile et rapide l&#x2019;&#xE9;criture du code de contr&#xF4;le des diff&#xE9;rents robots bas&#xE9;s sur - &#xE0; l&apos;origine - les servomoteurs dynamixel robotis. L&#x2019;id&#xE9;e &#xE9;tait de fournir un acc&#xE8;s depuis le bas niveau -communication s&#xE9;rie brute avec un moteur sp&#xE9;cifique par exemple- &#xE0; des niveaux plus &#xE9;lev&#xE9;s tels que le d&#xE9;marrage et l&#x2019;arr&#xEA;t de primitives/comportements (p. ex. suivi de visage, postures,...) ou l&apos;enregistrement directement des mouvements gr&#xE2;ce &#xE0; de l&#x2019;apprentissage par d&#xE9;monstration.</p>
<p>Nous avons d&#xE9;cid&#xE9; d&#x2019;&#xE9;crire la plupart d&apos;entre eux en Python, car sa souplesse permet un d&#xE9;veloppement rapide et modulaire. Elles &#xE9;taient &#xE9;galement destin&#xE9; &#xE0; &#xEA;tre accessible par un large public, de d&#xE9;veloppeurs, de roboticiens en g&#xE9;n&#xE9;ral, pour des amateurs, des chercheurs, des artistes... Python a &#xE9;galement &#xE9;t&#xE9; choisi pour l&apos;&#xE9;norme choix de biblioth&#xE8;ques existantes (scientifique, vision par ordinateur, web...), donc si quelqu&apos;un souhaite ajouter un nouvel &#xE9;l&#xE9;ment, comme le support &#xE0; un nouveau moteur/capteur, cela devrait &#xEA;tre r&#xE9;alisable le plus facilement et rapidement possible.</p>
<p>Enfin, le support multiplateforme et la facilit&#xE9; d&#x2019;installation &#xE9;taient &#xE9;galement des aspects essentiels.</p>
<h2 id="vue-densemble-des-diff&#xE9;rentes-biblioth&#xE8;ques">Vue d&#x2019;ensemble des diff&#xE9;rentes biblioth&#xE8;ques</h2>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> Une documentation plus d&#xE9;taill&#xE9;e de ces biblioth&#xE8;ques logicielles est disponible dans la <a href="../software-libraries/">section biblioth&#xE8;ques logicielles</a></p>
</blockquote>
<p>Avant de se lancer dans la programmation, nous allons pr&#xE9;senter bri&#xE8;vement les diff&#xE9;rentes biblioth&#xE8;ques Poppy existantes et comment elles interagissent entre elles.</p>
<p>Il y a trois principales biblioth&#xE8;ques logicielles :</p>
<ul>
<li><p><a href="https://github.com/poppy-project/pypot" target="_blank">pypot</a> : C&#x2019;est le c&#x153;ur de l&#x2019;architecture logicielle Poppy. Pypot g&#xE8;re toutes les communications de bas niveau avec le mat&#xE9;riel (capteurs et moteurs), d&#xE9;finit les boucles de synchronisation afin que votre commande soient toujours &#xE0; jour. Il fournit &#xE9;galement les primitives du m&#xE9;canisme qui permet la d&#xE9;finition d&#x2019;un comportement simple qui peut &#xEA;tre -plus ou moins- automatiquement combin&#xE9;s.</p>
</li>
<li><p><a href="https://github.com/poppy-project/poppy-ergo-jr" target="_blank">poppy-ergo-jr</a>, <a href="https://github.com/poppy-project/poppy-torso" target="_blank">poppy-torso</a>, and <a href="https://github.com/poppy-project/poppy-humanoid" target="_blank">poppy-humanoid:</a> ces biblioth&#xE8;ques sont sp&#xE9;cifiques &#xE0; chaque robot Poppy. Elles d&#xE9;finissent la configuration particuli&#xE8;re du robot, les capteurs utilis&#xE9;s, quels moteurs sont connect&#xE9;s &#xE0; quel bus... C&#x2019;est aussi ici que des comportements sp&#xE9;cifiques &#xE0; une cr&#xE9;ature sont d&#xE9;finis (la primitive qui fait Poppy Humanoid se tenir debout par exemple).</p>
</li>
</ul>
<p>Cela est r&#xE9;sum&#xE9; dans le sch&#xE9;ma ci-dessous :</p>
<p><img src="../img/python/architecture.png" alt="Architecture logicielle Poppy"></p>
<h2 id="installation">Installation</h2>
<p><strong>Tout d&#x2019;abord, notez que si vous n&#x2019;envisagez d&#x2019;utiliser que des robots r&#xE9;els, ils viennent avec Python et toutes les biblioth&#xE8;ques Poppy d&#xE9;j&#xE0; install&#xE9;es. Vous pouvez vous connecter directement au serveur Jupyter Notebook via l&apos;<a href="../getting-started/program-the-robot.html">interface web</a> et n&#x2019;avez rien &#xE0; installer sur votre machine !</strong></p>
<p>Ce que vous devez installer est r&#xE9;sum&#xE9; dans le sch&#xE9;ma ci-dessous :</p>
<p><img src="../img/python/what-to-install.png" alt="Ce qu&#x2019;il faut installer"></p>
<p>Ainsi, si vous pr&#xE9;voyez de soit</p>
<ul>
<li>Utiliser un simulateur (p. ex. CoppeliaSim ou simulateur web),</li>
<li>ou de brancher le robot &#xE0; votre ordinateur</li>
</ul>
<p>Vous devrez installer les biblioth&#xE8;ques Poppy localement. Elles fonctionnent sur Windows, Mac OSX, Linux et ont &#xE9;t&#xE9; test&#xE9;es sur Python &gt;= 3.5</p>
<p>Si vous planifiez de brancher votre robot directement suir votre port USB, des pilotes additionnelles devront &#xEA;tre install&#xE9;s.</p>
<p>Les &#xE9;tapes sont d&#xE9;taill&#xE9;es dans <a href="../installation/install-poppy-softwares.html">ce chapitre</a>.</p>
<h2 id="pour-d&#xE9;marrer--bonjour-poppy-">Pour d&#xE9;marrer : Bonjour Poppy !</h2>
<p>Afin de vous donner une vue d&apos;ensemble de ce que vous pouvez faire avec Poppy et Python, cette section va vous montrer comment :</p>
<ul>
<li>Crer et connecter votre robot</li>
<li>Consulter les valeurs renvoy&#xE9;es par les capteurs et les moteurs</li>
<li>Utiliser les primitives en enregistrant des mouvements</li>
</ul>
<p>Cette section ne pr&#xE9;tend pas tout couvrir ce qui est possible mais vous donne un bon bagage de d&#xE9;part. Pour un usage avanc&#xE9;, la section suivante vous pr&#xE9;sente des cahiers Jupyter Notebook &#xE0; suivre.</p>
<p>Dans ces exemples, nous supposons que vous disposez d&apos;un environnement fonctionnel, c&#xE0;d que vous avez soit :</p>
<ul>
<li>un robot branch&#xE9; avec sa Raspberry Pi : vous utiliser sont interpr&#xE9;teur Python pr&#xE9;install&#xE9; via le Jupyter Notebook</li>
<li>install&#xE9; les biblioth&#xE8;ques logicielles de votre cr&#xE9;ature sur votre ordinateur pour utiliser le simulateur</li>
<li>install&#xE9; les biblioth&#xE8;ques logicielles de votre cr&#xE9;ature sur votre ordinateur pour utiliser le robot branch&#xE9; en USB</li>
</ul>
<h3 id="cr&#xE9;er-et-se-connecter-au-robot">Cr&#xE9;er et se connecter au robot</h3>
<h4 id="importer-la-bilbioth&#xE8;que">Importer la bilbioth&#xE8;que</h4>
<p>La toute premi&#xE8;re &#xE9;tape est d&apos;importer la bilbioth&#xE8;que. Dans Python elles s&apos;appellent des <a href="https://docs.python.org/3/tutorial/modules.html" target="_blank">modules ou packages</a>.</p>
<p>Pour ce faire, la syntaxe est la suivante:</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.creatures <span class="hljs-keyword">import</span> *
</code></pre>
<p>L&apos;&#xE9;toile signifie &quot;<em>tout</em>&quot;, ce qui veut dire que nous allons importer toutes les cr&#xE9;atures Poppy install&#xE9;es sur votre ordinateur. Mais il est possible d&apos;en improter qu&apos;une seule ...</p>
<p>... par exemple celle de l&apos;Ergo Jr :</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.creatures <span class="hljs-keyword">import</span> PoppyErgoJr
</code></pre>
<p>... par exemple celle de Torso :</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.creatures <span class="hljs-keyword">import</span> PoppyTorso
</code></pre>
<p>... par exemple celle d&apos;Humanoid :</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.creatures <span class="hljs-keyword">import</span> PoppyHumanoid
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> Si une erreur similaire &#xE0; cette capture d&apos;&#xE9;cran appara&#xEE;t (erreur nomm&#xE9;e <code>Import Error</code>), alors votre installation des biblioth&#xE8;que Python a probablement &#xE9;chou&#xE9;. Reportez-vous &#xE0; la section d&apos;<a href="../installation/install-poppy-softwares.html">installation</a> pour recommencer.</p>
</blockquote>
<pre><code class="lang-python">In [1]: from pypot.creatures import PoppyHumanoid
ImportError Traceback (most recent call last)
&lt;ipython-input-1-18e4c5a36525&gt; in &lt;module&gt;()
----&gt; 1 from pypot.creatures import PoppyHumanoid

ImportError: cannot import name PoppyHumanoid
</code></pre>
<h4 id="cr&#xE9;er-lobjet-robot-avec-un-robot-r&#xE9;el">Cr&#xE9;er l&apos;objet &quot;Robot&quot; (avec un robot r&#xE9;el)</h4>
<p>L&apos;objet Robot est celui qui repr&#xE9;sente votre robot en Pyton. Selon votre cr&#xE9;ature, vous devez cr&#xE9;er un objet diff&#xE9;rent ...</p>
<p>... pour importer l&apos;objet de l&apos;Ergo Jr :</p>
<pre><code class="lang-python">poppy = PoppyErgoJr()
</code></pre>
<p>... pour importer l&apos;objet de Torso :</p>
<pre><code class="lang-python">poppy = PoppyTorso()
</code></pre>
<p>... pour importer l&apos;objet de l&apos;Humanoid :</p>
<pre><code class="lang-python"><span class="hljs-comment"># if you are using a Humanoid</span>
poppy = PoppyHumanoid()
</code></pre>
<p>Si aucune erreur n&apos;appara&#xEE;t, alors votre interpr&#xE9;teur Python est correctement connect&#xE9;. En revanche si une erreur similaire &#xE0; ceci apparait, alors certains de vos moteurs (voire tous) sont peut-&#xEA;tre mal connect&#xE9;s ou d&#xE9;fecteueux. V&#xE9;rifiez leur connectique et le sch&#xE9;ma de montage.</p>
<p><strong>Note</strong> Lorsqu&apos;elle survient, cette erreur vous indiquer le num&#xE9;ro du ou des moteur(s) posant probl&#xE8;me entre les crochets, cela peut vous aider &#xE0; situer la source du probl&#xE8;me. </p>
<pre><code class="lang-python">IOError: Connection to the robot failed! No suitable port found <span class="hljs-keyword">for</span> ids [<span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>]. These ids are missing [<span class="hljs-number">3</span>, <span class="hljs-number">5</span>, <span class="hljs-number">7</span>, <span class="hljs-number">11</span>, <span class="hljs-number">13</span>, <span class="hljs-number">17</span>] !
</code></pre>
<h4 id="cr&#xE9;er-lobjet-robot---avec-coppeliasim-v-rep">Cr&#xE9;er l&apos;objet Robot - avec CoppeliaSim (V-REP)</h4>
<p>To use a simulated robot instead of a real one, you only have to specify it when creating the Robot object. For instance, if you want to create a simulated Poppy Torso, you simply have to execute the following line:</p>
<pre><code class="lang-python">poppy = PoppyTorso(simulator=<span class="hljs-string">&apos;vrep&apos;</span>)
</code></pre>
<p>All three Poppy robots - Humanoid, Torso, and Ergo Jr - can be used with CoppeliaSim.</p>
<p>If you see an error message like this, check that you have launched CoppeliaSim and that you have close the popup in CoppeliaSim (see <a href="../installation/install-vrep.html#test-your-installation">this chapter</a> for details).</p>
<pre><code class="lang-python">IOError: Connection to CoppeliaSim failed!
</code></pre>
<h4 id="create-the-robot-object---with-web-simulator">Create the Robot object - with web simulator</h4>
<p>Currently only the Ergo Jr is usable within the web simulator. It also requires specific versions of libraries to be used properly.</p>
<p>To make sure you meet these requirements, you can type this command from your shell:</p>
<pre><code class="lang-bash">pip install pypot&gt;=2.12 poppy-creature&gt;=1.8 poppy-ergo-jr&gt;=1.6 --upgrade
</code></pre>
<p>Vous pouvez ensuite instancier la cr&#xE9;ature poppy-ergo-jr :</p>
<pre><code class="lang-bash">poppy-services --poppy-simu --snap --no-browser poppy-ergo-jr
</code></pre>
<p>Cela va cr&#xE9;er un serveur pour Snap<em> ! </em> sur port 6969 et un serveur pour le visualiseur sur le port 8080.</p>
<p>Vous pouvez ensuite vous diriger vers la <a href="http://simu.poppy-project.org/" target="_blank">page du visualiseur</a>.</p>
<h3 id="acc&#xE9;der-aux-capteurs-et-aux-moteurs">Acc&#xE9;der aux capteurs et aux moteurs</h3>
<p>L&#x2019;objet robot que vous venez de cr&#xE9;er contient deux groupes principaux d&#x2019;objets :</p>
<ul>
<li>moteurs</li>
<li>sensors</li>
</ul>
<p>auxquelles on peut facilement acc&#xE9;der &#xE0; l&#x2019;aide de <em>poppy.motors</em> et <em>poppy.sensors</em>. D&#xE8;s que l&#x2019;objet robot est cr&#xE9;&#xE9;, il d&#xE9;bute automatiquement des boucles de synchronisation qui assurerons que les derni&#xE8;res valeurs disponibles sont re&#xE7;us/envoy&#xE9;s au robot.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> Les servomoteurs qui sont utilis&#xE9;s dans des robots Poppy peuvent &#xEA;tre consid&#xE9;r&#xE9;s &#xE0; la fois comme des moteurs ou des capteurs. Indeed, on top of being &quot;simple&quot; motors, they also provide multiple sensing information: their current position, speed and load but also their temperature, the current used... Yet, for simplification they are only available under the motor category.</p>
</blockquote>
<h4 id="get-data-from-your-robot">Get data from your robot</h4>
<!-- TODO: connecter un ergo et ajouter les res. des differentes lignes -->
<p>Now that you have created your robot object, you can directly use Python to discover which motors are attached.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> In all examples below the results are shown for an ErgoJr. If you are using a Torso or a Humanoid you will see more motors with different names.</p>
</blockquote>
<p>For instance, to know how many motors your robot have you can execute:</p>
<pre><code class="lang-python">print(len(poppy.motors))
</code></pre>
<p><em>poppy.motors</em> is actually a list of all motors connected to your robot. Thus, if you want to get the present position of all motors, you can do:</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> poppy.motors:
    print(m.present_position)
</code></pre>
<p>Of course, you can also access a specific motor. To do that, you need to know the name for the motor you want to access. You can find this list in the assembly documentation of your robot.</p>
<p>You can also get a list of all motors name directly from python:</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> poppy.motors:
    print(m.name)
</code></pre>
<p>or using a motor pythonic expression:</p>
<pre><code class="lang-python">print([m.name <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> poppy.motors])
</code></pre>
<p>Then you can directly access the desired motor by its name:</p>
<pre><code class="lang-python">m = poppy.m3
</code></pre>
<p>or get its position:</p>
<pre><code class="lang-python">print(poppy.m3.present_position)
</code></pre>
<p>The most common values for motors are: <em> present_position </em> present_speed * present_load</p>
<p>Similarly, you can get data from your sensors. Depending on the Poppy robot you have different sensors available. You can get the list of all sensors in the exact same way you did for motors:</p>
<pre><code class="lang-python">print([s.name <span class="hljs-keyword">for</span> s <span class="hljs-keyword">in</span> poppy.sensors])
</code></pre>
<p>And then access a specific sensors by its name. For instance, to get an image from the camera of the Ergo Jr:</p>
<pre><code class="lang-python">img = poppy.camera.frame
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> This section just presented some of the available values that you can get from your motors/sensors. They are many other - some are specific to a particular robot - we will present them through the different notebooks.</p>
</blockquote>
<h4 id="send-motor-commands">Send motor commands</h4>
<p>Now that we have shown you how to read values from your robot, it is time to learn how to make it move!</p>
<p>This is actually really similar to what you have just seen. Instead of getting the <em>present_position</em> of a motor you simply have to set its <em>goal_position</em>.</p>
<p>But first, you have to make sure your motor is stiff, meaning that you cannot move it by hand. To do that we will turn off its compliancy. Assuming you have an Ergo Jr and want to make the motor <em>m3</em> moves - feel free to use any other motor but make sure the motor can freely move without hurting any of your finger:</p>
<pre><code class="lang-python">poppy.m3.compliant = <span class="hljs-keyword">False</span>
</code></pre>
<p>The motor should now be stiff. And then, to make it move to its zero position:</p>
<pre><code class="lang-python">poppy.m3.goal_position = <span class="hljs-number">0</span>
</code></pre>
<blockquote>
<p>Note: <em>present_position</em> and <em>goal_position</em> are actually two different registers. The first refers to the current position of the motor (read only) while the second corresponds to the target position you want your robot to reach. Thus, they can have different values while the motor is still moving to reach its <em>goal_position</em>.</p>
</blockquote>
<p>As a slightly more complex example we will make it go to 30 degrees then -30&#xB0; three times:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> time

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):
    poppy.m3.goal_position = <span class="hljs-number">30</span>
    time.sleep(<span class="hljs-number">0.5</span>)
    poppy.m3.goal_position = <span class="hljs-number">-30</span>
    time.sleep(<span class="hljs-number">0.5</span>)
</code></pre>
<p>Note that after each new value set to <em>goal_position</em> we wait so the motor has enough time to actually reach this new position. Another way to do the same thing is to use the goto_position method:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> time

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):
    poppy.m3.goto_position(<span class="hljs-number">30</span>, <span class="hljs-number">0.5</span>, wait=<span class="hljs-keyword">True</span>)
    poppy.m3.goto_position(<span class="hljs-number">-30</span>, <span class="hljs-number">0.5</span>, wait=<span class="hljs-keyword">True</span>)
</code></pre>
<p>As you can see, this method takes three arguments, the target position, the duration of the move and whether to wait or not the end of the motion.</p>
<p>If you want to move multiple motors at the same time, you can simply do something like:</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):
    poppy.m1.goal_position = <span class="hljs-number">-20</span>
    poppy.m3.goal_position = <span class="hljs-number">30</span>
    time.sleep(<span class="hljs-number">0.5</span>)
    poppy.m1.goal_position = <span class="hljs-number">20</span>
    poppy.m3.goal_position = <span class="hljs-number">-30</span>
    time.sleep(<span class="hljs-number">0.5</span>)
</code></pre>
<p>or use a python dictionary storing the target position per motor you want to move, that can be given to the goto_position method:</p>
<pre><code class="lang-python">pos_1 = {<span class="hljs-string">&apos;m1&apos;</span>: <span class="hljs-number">-20</span>, <span class="hljs-string">&apos;m3&apos;</span>: <span class="hljs-number">30</span>}
pos_2 = {<span class="hljs-string">&apos;m1&apos;</span>: <span class="hljs-number">20</span>, <span class="hljs-string">&apos;m3&apos;</span>: <span class="hljs-number">-30</span>}

<span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):
    poppy.goto_position(pos_1, <span class="hljs-number">0.5</span>, wait=<span class="hljs-keyword">True</span>)
    poppy.goto_position(pos_2, <span class="hljs-number">0.5</span>, wait=<span class="hljs-keyword">True</span>)
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> You can turn a motor back to its compliant mode (where you can freely move it) by setting its compliant register to True:</p>
</blockquote>
<pre><code class="lang-python">poppy.m3.compliant = <span class="hljs-keyword">True</span>
</code></pre>
<h3 id="record-and-play-motion-by-demonstration-using-primitives">Record and play motion by demonstration using primitives</h3>
<p>Pypot provides you with the primitive mechanism, which are simply pre-defined behaviors that can be attached to your robot. In this section, we will show you how to use some primitives already existing for recording and playing motions. You can also define your own primitive but this is out of the scope of this section, you will find details on how to do this in dedicated notebooks.</p>
<h4 id="record-a-motion-by-demonstration">Record a motion by demonstration</h4>
<p>Designing choreographies for your robot using <em>goal_position</em> or <em>goto_position</em> can be long and kind of troublesome. Fortunately, there is a much more efficient way of doing this: recording motions by directly demonstrating the move on the robot.</p>
<p>This can be summarized into few steps:</p>
<ul>
<li>make the robot compliant so you can move it by hand</li>
<li>start the recording</li>
<li>actually moves the robot so it follows whatever move/choreography you can think of</li>
<li>stop the recording</li>
</ul>
<p>And now to do that in Python:</p>
<p>So, first we turn all motors of the robot compliants:</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> poppy.motors:
    m.compliant = <span class="hljs-keyword">True</span>
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-info"></strong>
<p> You can also record a movement with motors stiff (<code>compliant = False</code>), and moving them with goal_position or goto_position commands.</p>
</blockquote>
<p>Then, we have to include the primitive used for recording motion:</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.primitive.move <span class="hljs-keyword">import</span> MoveRecorder
</code></pre>
<p>To create this primitive, you have to give the following arguments:</p>
<ul>
<li><p>on which robot you want to use this primitive (this can be useful if you are working with multiple robot at a time - for instance you can record a move on a robot and at the same time make it reproduce by another one. <!-- this [notebook](#TODO) will guide you on how to do this). --></p>
</li>
<li><p>the record frequency of the move you want to register: how many position per second will be recorded - the higher the more accurate the record will be but also more data will have to be processed - good values are usually between 10Hz and 50Hz.</p>
</li>
<li><p>the motors that you want to record. you can record a move on a subpart of you robot, for instance only on the left arm.</p>
</li>
</ul>
<p>Here, we will record a move on the whole robot at 50Hz:</p>
<pre><code class="lang-python">record = MoveRecorder(poppy, <span class="hljs-number">50</span>, poppy.motors)
</code></pre>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> We used <em>poppy.motors</em> to specify that we want all motors if you only want let&apos;s say the two first motors of an Ergo Jr you could have used <em>[poppy.m1, poppy.m2]</em> instead.</p>
</blockquote>
<p>Now it is time to record. As it can be hard to both move the robot and type Python command at the same time, we will make a small script, that:</p>
<ul>
<li>wait 5s so you can get ready to record</li>
<li>start the record</li>
<li>record for 10 seconds</li>
<li>stop the records</li>
</ul>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> time

<span class="hljs-comment"># Give you time to get ready</span>
print(<span class="hljs-string">&apos;Get ready to record a move...&apos;</span>)
time.sleep(<span class="hljs-number">5</span>)

<span class="hljs-comment"># Start the record</span>
record.start()
print(<span class="hljs-string">&apos;Now recording !&apos;</span>)

<span class="hljs-comment"># Wait for 10s so you can record what you want</span>
time.sleep(<span class="hljs-number">10</span>)

<span class="hljs-comment"># Stop the record</span>
print(<span class="hljs-string">&apos;The record is over!&apos;</span>)
record.stop()
</code></pre>
<p>Now, you should have a move recorded. You can retrieve it from the recorder primitive:</p>
<pre><code class="lang-python">my_recorded_move = record.move
</code></pre>
<p>and check how many positions where recorded:</p>
<pre><code class="lang-python">print(len(my_recorded_move.positions()))
</code></pre>
<h4 id="replay-recorded-moves">Replay recorded moves</h4>
<p>Now to play back recorded motions you have to use another primitive: MovePlayer</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.primitive.move <span class="hljs-keyword">import</span> MovePlayer

player = MovePlayer(poppy, my_recorded_move)
</code></pre>
<p>As you can see, to create it you have to specify the robot (as for the MoveRecorder) and the move you want to play.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> Automatically all recorded motors become stiff to be able to play the move.</p>
</blockquote>
<p>Then, you can simply start the replay:</p>
<pre><code class="lang-python">player.start()
</code></pre>
<p>And if you want to play it three times in a row:</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> range(<span class="hljs-number">3</span>):
    player.start()
    player.wait_to_stop()
</code></pre>
<p>We use the <em>wait_to_stop</em> method to make sure we wait for the first move to finish before we start another. By default, playing a move we will not block to allow you to play multiple move in parallel.</p>
<h3 id="write-a-simple-sensori-motor-loop">Write a simple sensori-motor loop</h3>
<p>Robotic is all about sensori-motor loops, meaning that motor commands will be more or less directly related to the sensor readings. In other terms the robot actions will be determined by what it perceives from its environment.</p>
<p>Poppy libraries and more particularly pypot provides you with tools to easily write sensori-motor loops. We will show here a very simple example where some motor of an Ergo Jr will be controlled by the position of other motors in order to keep the head of the Ergo Jr straight.</p>
<p>To do that, we will free the two first motors, so they can be moved by hand. Two other motors will try to lively compensate the motion applied on the free motors.</p>
<p>We need few simple steps:</p>
<ol>
<li>read values from sensors (here the two free motors)</li>
<li>compute command from those readings</li>
<li>set new motor command</li>
<li>go back to step 1.</li>
</ol>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> This example is designed for the Ergo Jr. It could be adapted to other Poppy robots, by changing the motors used. Yet, it is not that obvious which one to use to have a &quot;cool&quot; result.</p>
</blockquote>
<h4 id="demo-version">Demo version</h4>
<p>Before writing the sensori-motor loop, we will first set the Ergo Jr in a base position.</p>
<pre><code class="lang-python"><span class="hljs-keyword">from</span> pypot.creatures <span class="hljs-keyword">import</span> PoppyErgoJr

jr = PoppyErgoJr()

jr.goto_position({<span class="hljs-string">&apos;m1&apos;</span>: <span class="hljs-number">0.</span>,
                  <span class="hljs-string">&apos;m2&apos;</span>: <span class="hljs-number">-60.</span>,
                  <span class="hljs-string">&apos;m3&apos;</span>: <span class="hljs-number">55.</span>,
                  <span class="hljs-string">&apos;m4&apos;</span>: <span class="hljs-number">0.</span>,
                  <span class="hljs-string">&apos;m5&apos;</span>: <span class="hljs-number">-55.</span>,
                  <span class="hljs-string">&apos;m6&apos;</span>: <span class="hljs-number">60.</span>}, <span class="hljs-number">2.</span>, wait=<span class="hljs-keyword">True</span>)
</code></pre>
<p>Then, we make sure the <em>moving speed</em> of the motors are not too high to prevent shaky motions:</p>
<pre><code class="lang-python"><span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> jr.motors:
    m.moving_speed = <span class="hljs-number">250</span>
</code></pre>
<p>Finally, we free the two first motors:</p>
<pre><code class="lang-python">jr.m1.compliant = <span class="hljs-keyword">True</span>
jr.m2.compliant = <span class="hljs-keyword">True</span>
</code></pre>
<p>Now, that everything is setup we write our very simple sensori-motor loop like this:</p>
<pre><code class="lang-python"><span class="hljs-keyword">import</span> time

<span class="hljs-keyword">while</span> <span class="hljs-keyword">True</span>:
    <span class="hljs-comment"># Step 1</span>
    p1 = jr.m1.present_position
    p2 = jr.m2.present_position

    <span class="hljs-comment"># Step 2</span>
    g1 = -p1
    g2 = -p2

    <span class="hljs-comment"># Step 3</span>
    jr.m4.goal_position = g1
    jr.m6.goal_position = g2

    time.sleep(<span class="hljs-number">.02</span>)
</code></pre>
<ul>
<li><strong>Step 1:</strong> As you can see, here our readings step is simply to retrieve the <em>present_position</em> of the motors <em>m1</em> and <em>m2</em>.</li>
<li><strong>Step 2:</strong> Here, we defined the base position so the motors <em>m1</em>/<em>m4</em> and <em>m2</em>/<em>m6</em> are parallel. Thus, to compensate the head position, we simply have to define the new motor goal position as the opposite of the read present position.</li>
<li><strong>Step 3:</strong> We simply set the goal position as the just computed command</li>
</ul>
<p>Those steps are included inside an infinite loop - with a <code>time.sleep</code> to avoid CPU overhead.</p>
<blockquote class="clearfix alert alert-info"><strong class="fa fa-2x fa-edit"></strong>
<p> To stop this <em>while True</em> loop, you will have to use the classical Ctrl-c, or use the stop button if you are running it through Jupyter.</p>
</blockquote>
<h4 id="now-with-a-primitive">Now with a primitive</h4>
<p>But what about if you want to make this behavior an independent &quot;brick&quot; that you can start/stop on demand combine with other behaviors. Well, primitives are meant to do just that.</p>
<p>There is two main types of primitive: <em>Primitive</em> and <em>LoopPrimitive</em>. The first one basically gives you access to just a <em>run</em> method where you can do everything you want on a robot. The second one as the name indicates is an infinite loop which calls an <em>update</em> method at a pre-defined frequency. In our case it is the more suited one.</p>
<p>Here is the entire definition of this primitive:</p>
<pre><code class="lang-python"><span class="hljs-class"><span class="hljs-keyword">class</span> <span class="hljs-title">KeepYourHeadStraight</span><span class="hljs-params">(LoopPrimitive)</span>:</span>
    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">setup</span><span class="hljs-params">(self)</span>:</span>
        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> self.robot.motors:
            m.compliant = <span class="hljs-keyword">False</span>

        self.robot.goto_position({<span class="hljs-string">&apos;m1&apos;</span>: <span class="hljs-number">0.</span>,
                                  <span class="hljs-string">&apos;m2&apos;</span>: <span class="hljs-number">-60.</span>,
                                  <span class="hljs-string">&apos;m3&apos;</span>: <span class="hljs-number">55.</span>,
                                  <span class="hljs-string">&apos;m4&apos;</span>: <span class="hljs-number">0.</span>,
                                  <span class="hljs-string">&apos;m5&apos;</span>: <span class="hljs-number">-55.</span>,
                                  <span class="hljs-string">&apos;m6&apos;</span>: <span class="hljs-number">60.</span>}, <span class="hljs-number">2.</span>, wait=<span class="hljs-keyword">True</span>)

        <span class="hljs-keyword">for</span> m <span class="hljs-keyword">in</span> self.robot.motors:
            m.moving_speed = <span class="hljs-number">250</span>

        self.robot.m1.compliant = <span class="hljs-keyword">True</span>
        self.robot.m2.compliant = <span class="hljs-keyword">True</span>

    <span class="hljs-function"><span class="hljs-keyword">def</span> <span class="hljs-title">update</span><span class="hljs-params">(self)</span>:</span>
        self.robot.m4.goal_position = -self.robot.m1.present_position
        self.robot.m6.goal_position = -self.robot.m2.present_position
</code></pre>
<p>As you can see, there is two main parts. The <strong><em>setup</em></strong> method which defines what needs to be done to prepare the robot before starting the behavior - here simply puts it in its base position and turn on the compliance for the two first motors.</p>
<p>And the <strong><em>update</em></strong> method which will be regularly called: here is where we put the actual code for the sensori-motor loop: reading sensor - computing the new command - and sending the new command to the motors.</p>
<p>Now that we have defined our primitive, we can instantiate it and start it:</p>
<pre><code class="lang-python"><span class="hljs-comment"># we specify we want the primitive to apply on the jr robot instance</span>
<span class="hljs-comment"># and that the update method should be called at 50Hz</span>
head_straight = KeepYourHeadStraight(jr, <span class="hljs-number">50.0</span>)

head_straight.start()
</code></pre>
<p>You can stop it whenever you want:</p>
<pre><code class="lang-python">head_straight.stop()
</code></pre>
<p>And re-starting it again...</p>
<pre><code class="lang-python">head_straight.start()
</code></pre>
<p>The huge advantage of using a primitive in this case is that after starting it, you can still easily run any other codes that you want. The primitive starts its own thread and thus runs in background without blocking the execution of the rest of the code.
<div id="page-footer" class="localized-footer"><hr><h4 id="des-questions-">Des questions ?</h4>
<p>Nous sommes toujours heureux de vous aider sur un probl&#xE8;me de programmation ou sur tout autre question que vous pourriez avoir ! N&apos;h&#xE9;sitez pas &#xE0; poser vos questions et partager des solutions sur notre <a href="https://forum.poppy-project.org" target="_blank">forum communautaire</a>.</p>
</div></p>

                                
                                </section>
                            
    </div>
    <div class="search-results">
        <div class="has-results">
            
            <h1 class="search-results-title"><span class='search-results-count'></span> results matching "<span class='search-query'></span>"</h1>
            <ul class="search-results-list"></ul>
            
        </div>
        <div class="no-results">
            
            <h1 class="search-results-title">No results matching "<span class='search-query'></span>"</h1>
            
        </div>
    </div>
</div>

                        </div>
                    </div>
                
            </div>

            
                
                <a href="notebooks.html" class="navigation navigation-prev " aria-label="Previous page: Utilisation des notebooks Jupyter">
                    <i class="fa fa-angle-left"></i>
                </a>
                
                
                <a href="rest.html" class="navigation navigation-next " aria-label="Next page: API des robots">
                    <i class="fa fa-angle-right"></i>
                </a>
                
            
        
    </div>

    <script>
        var gitbook = gitbook || [];
        gitbook.push(function() {
            gitbook.page.hasChanged({"page":{"title":"Programmation en Python","level":"5.1.3","depth":2,"next":{"title":"API des robots","level":"5.1.4","depth":2,"path":"programming/rest.md","ref":"programming/rest.md","articles":[]},"previous":{"title":"Utilisation des notebooks Jupyter","level":"5.1.2","depth":2,"path":"programming/notebooks.md","ref":"programming/notebooks.md","articles":[]},"dir":"ltr"},"config":{"plugins":["-search","-share","anchorjs","build","copy-code-button","custom-favicon","github","language-picker","localized-footer","page-toc","richquotes","search-plus","sitemap","toggle-chapters","toggle-headers","youtube"],"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"pluginsConfig":{"language-picker":{"grid-columns":3},"youtube":{},"github":{"url":"https://github.com/poppy-project/poppy-docs"},"page-toc":{"position":"before-first","selector":".markdown-section h2, .markdown-section h3","showByDefault":true},"localized-footer":{"filename":"FOOTER.md","hline":"true"},"lunr":{"maxIndexSize":1000000,"ignoreSpecialCharacters":false},"toggle-headers":{},"build":{"args":[],"bin":"pandoc","format":"latex","opts":{},"output":"_book/main.tex","template":"_layouts/main.tex"},"fontsettings":{"theme":"white","family":"sans","size":2},"richquotes":{},"highlight":{},"favicon":"favicon.ico","sitemap":{"hostname":"https://docs.poppy-project.org/"},"custom-favicon":{},"copy-code-button":{},"sharing":{"facebook":false,"twitter":false,"google":false,"weibo":false,"instapaper":false,"vk":false,"all":["twitter","facebook","google","weibo","instapaper"]},"edit-link":{"base":"https://github.com/poppy-project/poppy-docs/edit/master/","label":{"en":"Edit this page","fr":"Editez cette page"}},"theme-default":{"styles":{"website":"styles/website.css","pdf":"styles/pdf.css","epub":"styles/epub.css","mobi":"styles/mobi.css","ebook":"styles/ebook.css","print":"styles/print.css"},"showLevel":true},"anchorjs":{},"toggle-chapters":{},"search-plus":{}},"theme":"default","pdf":{"pageNumbers":true,"fontSize":12,"fontFamily":"Arial","paperSize":"a4","chapterMark":"pagebreak","pageBreaksBefore":"/","margin":{"right":62,"left":62,"top":56,"bottom":56}},"structure":{"langs":"LANGS.md","readme":"README.md","glossary":"GLOSSARY.md","summary":"SUMMARY.md"},"variables":{"poppy_doc_version":"1.0","poppy-humanoid_humanoid_hardware_version":"1.0","poppy-humanoid_humanoid_software_version":"1.0","poppy-torso_hardware_version":"1.0","poppy-torso_software_version":"1.0","poppy-ergo-jr_hardware_version":"1.0","poppy-ergo-jr_software_version":"1.0"},"title":"Documentation of the Poppy Platform","language":"fr","gitbook":"*"},"file":{"path":"programming/python.md","mtime":"2020-12-24T18:52:21.038Z","type":"markdown"},"gitbook":{"version":"3.2.3","time":"2020-12-24T18:53:09.804Z"},"basePath":"..","book":{"language":"fr"}});
        });
    </script>
</div>

        
    <script src="../../gitbook/gitbook.js"></script>
    <script src="../../gitbook/theme.js"></script>
    
        
        <script src="../../gitbook/gitbook-plugin-anchorjs/anchor.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-anchorjs/anchor-style.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-copy-code-button/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-github/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-language-picker/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc/anchor-3.1.1.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-page-toc/page-toc.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/jquery.mark.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-search-plus/search.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-toggle-chapters/toggle.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-toggle-headers/plugin.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/lunr.min.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-lunr/search-lunr.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-sharing/buttons.js"></script>
        
    
        
        <script src="../../gitbook/gitbook-plugin-fontsettings/fontsettings.js"></script>
        
    

    </body>
</html>

